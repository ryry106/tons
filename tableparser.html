<html>

<head>
  <script>
    const runner = () => {
      const convertTable2Array = () => {
        return Array.from(document.querySelectorAll("tr")).map((trElm) => {
          return Array.from(trElm.querySelectorAll("td")).map(tdElm => tdElm.textContent)
        })
      }

      // 指定した列の空行を埋める
      const emptyColumnComplement = (target, index) => {
        if (!target) {
          return target
        }

        let supplyLastElm = ""
        return target.map(elm => {
          const clone = elm.concat()
          if (clone[index] === "") {
            clone[index] = supplyLastElm
          }
          supplyLastElm = clone[index]
          return clone
        })
      }

      (() => {
        const tableArray = convertTable2Array()

        let s1 = emptyColumnComplement(tableArray, 0)
        let s2 = emptyColumnComplement(s1, 1)

        console.log(s1)
        console.log(s2)

      })()

    }
  </script>
  <script>
    window.addEventListener('load', (event) => {runner()});
  </script>
</head>

<body>
  <div>
    <table>
      <tr>
        <td>h1</td>
        <td>h2</td>
        <td>h3</td>
      </tr>
      <tr>
        <td>1</td>
        <td></td>
        <td></td>
      </tr>
      <tr>
        <td></td>
        <td>2</td>
        <td></td>
      <tr>
        <td></td>
        <td></td>
        <td>3-1</td>
      </tr>
      <tr>
        <td></td>
        <td></td>
        <td>3-2</td>
      </tr>
      <tr>
        <td></td>
        <td>20</td>
        <td></td>
      <tr>
        <td></td>
        <td></td>
        <td>30-1</td>
      </tr>
      <tr>
        <td></td>
        <td></td>
        <td>30-2</td>
      </tr>
    </table>
  </div>
</body>

</html>
